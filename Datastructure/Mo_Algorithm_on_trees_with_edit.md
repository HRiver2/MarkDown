# 树上带修莫队


结合经典题[糖果公园](https://www.luogu.com.cn/problem/P4074)分析该算法.

## 题面简述

一棵树, $n$ 个点, 每点颜色为 $m$ 中颜色中的一种. $V_i$ 表示第 $i$ 种颜色的权值. $W_i$ 表示一种颜色出现第 $i$ 次的权值. 两种操作, 一种是将单点的颜色修改为已有的 $m$ 种颜色中的另一种. 第二种操作是对这棵树上的路径进行查询. 如果用 $Cnt_i$ 表示路径上颜色为 $i$ 的点的出现次数, 则一个路径的权值是这个路径上的所有颜色的权值乘它们的出现次数对应的权值的前缀和的总和. 可能语言表述有些绕, 接下来用公式表示. 

$$
\sum_{i = 1}^{m}(V_i\sum_{j = 1}^{Cnt_i}(W_j))
$$

