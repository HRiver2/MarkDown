# 扩展欧拉定理

## 欧拉函数 $\phi$

设 $\phi(x)$ 为 $[1, x]$ 范围内和 $x$ 互质的数的数量.

对于质数 $x$, 由于和 $[1, x - 1]$ 中任意数字互质, 所以有结论

$$
\phi(x) = x - 1
$$

对于正整数 $x$, $p_i$ 表示第 $i$ 个质数, 由正整数的唯一分解设

$$
x = \prod_{i}^{p_i | x} p_i^{a_i}
$$

由于被 $p_i$ 整除的数有 $x / p_i$ 个, 这些数一定不和 $x$ 互质. 结合容斥原理, 对于所有的 $p_i|x$, 和 $x$ 互质的数有

$$
\sum_{i}^{p_i|x} x/p_i - \sum_{i, j}^{p_ip_j|x} x/(p_ip_j) + \sum_{i, j, k}^{p_ip_jp_k|x} x/(p_ip_jp_k) - 
$$

对于正整数 $x$, 设 $x = ab$, 由于, 则有结论

$$
\phi(x) = \phi(a)\phi(b)
$$

我们把

## 欧拉定理

$a$, $p$ 互质

$$
a
$$